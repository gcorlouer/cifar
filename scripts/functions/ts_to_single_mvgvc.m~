function F= ts_to_single_mvgvc(X, args)

arguments
    X double % Time series
    args.gind struct % group indices 
    args.morder double = 3 % model order
    args.regmode char = 'OLS' % model regression (OLS or LWR)
end

gind = args.gind; morder = args.morder; regmode = args.regmode;
gi = fieldnames(gind); 

ng = length(gi); % Number of groups

[n,m,N]=size(X);
F = zeros(ng, ng, N);

VAR = ts_to_var_parameters(X, 'morder', morder, 'regmode', regmode);
for k=1:N
    for i=1:ng
        for j=1:ng
            x = gind.(gi{i});
            y = gind.(gi{j});
            nx = length(x); ny = length(y); nz = n -nx - ny;
            if i==j
                % Return causal density for diagonal elements
                % Compute pairwise conditional GC
                pF = var_to_pwcgc(VAR.A, VAR.V, morder,regmode);
                % Return 0 when group of channel is singleton
                pF(isnan(pF))=0;
                % Average over each type of populations
                F(i,j,k) = mean(pF(x,y),'all');
            else 
                % Return mvgc between group of populations
                F(i,j,k) = var_to_mvgc_tstat(X(:,:,k),VAR.V,x,y,morder,regmode,tstat);
            end
            % Compute corrected pvalue and significance
            pval(i,j) = mvgc_pval(F(i,j),tstat,nx,ny,nz,morder,m,N);
            [sigF(i,j), pcrit] = significance(pval(i,j),alpha,mhtc,[]);
        end
    end
end
end